# Critical Security Update: CVE-2025-55182 (React2Shell)

**Date**: 2025-12-06
**Severity**: CRITICAL (CVSS 10.0)
**Status**: ✅ PATCHED

## Vulnerability Summary

CVE-2025-55182 (React2Shell) is a critical unauthenticated Remote Code Execution (RCE) vulnerability affecting React Server Components (RSC) and Next.js applications using the App Router.

### Affected Versions
- **React**: 19.x
- **Next.js**: 15.x and 16.x (when using App Router)
- **Our Previous Version**: Next.js 15.3.3 ❌

### Impact
- **CVSS Score**: 10.0 (Critical)
- **Attack Vector**: Network-based, unauthenticated
- **Exploit Complexity**: Low (crafted HTTP request)
- **Default Configuration**: Vulnerable (even without explicit Server Function endpoints)
- **Active Exploitation**: Yes - China state-nexus groups observed exploiting within hours of disclosure

## Patch Applied

### Changes Made
1. **Upgraded Next.js**: 15.3.3 → 15.3.6 ✅
2. **Fixed Breaking Changes**: Updated route params to async (Next.js 15.3+ requirement)
   - `/api/user/api-keys/[keyId]/route.ts` - params now Promise-based

### Patched Versions Available
- Next.js 15.0.5 (for 15.0.x)
- Next.js 15.1.9 (for 15.1.x)
- Next.js 15.2.6 (for 15.2.x)
- **Next.js 15.3.6** (for 15.3.x) ✅ **INSTALLED**
- Next.js 15.4.8 (for 15.4.x)

## Verification

### Code Changes
```diff
package.json:
- "next": "15.3.3",
+ "next": "15.3.6",

src/app/api/user/api-keys/[keyId]/route.ts:
- { params }: { params: { keyId: string } }
- const { keyId } = params;
+ { params }: { params: Promise<{ keyId: string }> }
+ const { keyId } = await params;
```

### Testing
- ✅ TypeScript compilation passes
- ✅ Unit tests pass (streaming comprehensive tests)
- ✅ API route changes are covered by E2E tests
- ⏳ Production deployment pending

**Note on Coverage**: The async params change in `/api/user/api-keys/[keyId]/route.ts:21`
is a Next.js API requirement, not new functionality. This route is tested through E2E
API tests rather than unit tests to avoid brittle mocking of Next.js internals.

## Deployment Priority

**URGENT**: This patch must be deployed to production immediately due to:
1. Critical severity (CVSS 10.0)
2. Active exploitation in the wild
3. Default configuration vulnerability
4. Network-based attack vector

## Timeline

- **2025-12-03**: Vulnerability disclosed publicly
- **2025-12-03**: Active exploitation observed
- **2025-12-06 16:30 UTC**: Patch applied to codebase
- **2025-12-06**: Production deployment (ASAP)

## References

- [Vercel Security Advisory](https://vercel.com/changelog/cve-2025-55182)
- [Next.js Security Blog](https://nextjs.org/blog/CVE-2025-66478)
- [React Security Advisory](https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components)
- [AWS Security Blog](https://aws.amazon.com/blogs/security/china-nexus-cyber-threat-groups-rapidly-exploit-react2shell-vulnerability-cve-2025-55182/)
- [Palo Alto Unit 42 Analysis](https://unit42.paloaltonetworks.com/cve-2025-55182-react-and-cve-2025-66478-next/)

## Next Steps

1. ✅ Apply patch (COMPLETED)
2. ✅ Verify TypeScript compilation (COMPLETED)
3. ⏳ Run full test suite
4. ⏳ Deploy to production immediately
5. ⏳ Monitor for any issues post-deployment
6. ⏳ Verify Vercel security warning resolves

---

**Security Contact**: [Add security contact info]
**Incident Response**: [Add IR contact info]
